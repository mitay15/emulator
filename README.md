# AAPS Emulator

Небольшой набор инструментов для воспроизведения и анализа AutoISF логики (AAPS).
Проект содержит парсер логов, реализацию алгоритма AutoISF и утилиты для сравнения с эталонными результатами.

## Быстрый старт (для новичка)

### 1) Клонировать репозиторий
```bash
git clone <repo-url>
cd <repo-dir>


Как читать HTML-отчёт
HTML‑отчёт покрытия — это визуальная карта того, какие строки твоего кода реально выполнялись во время тестов. Он помогает понять, **что уже проверено**, а **что может скрывать ошибки**.

Ниже — понятное объяснение, как его читать и что в нём важно.

---

## Что ты увидишь, когда откроешь `htmlcov/index.html`

### 1. Главная таблица файлов
Это первая страница. В ней есть столбцы:

- **File** — путь к файлу
- **Statements** — количество строк кода
- **Miss** — сколько строк не покрыто тестами
- **Cover** — процент покрытия
- **Missing** — номера строк, которые не были выполнены

Например:

| File | Stmts | Miss | Cover | Missing |
|------|-------|-------|--------|----------|
| autoisf_algorithm.py | 1200 | 150 | 87% | 100–120, 450–470 |

Это означает:

- файл большой (1200 строк)
- 150 строк не покрыты тестами
- покрытие 87%
- конкретные пропуски — строки 100–120 и 450–470

---

## Как читать отдельный файл

Кликни по `autoisf_algorithm.py` — откроется страница с подсветкой строк.

### Цвета:

- **Зелёный** — строка была выполнена тестами
- **Красный** — строка не была выполнена
- **Жёлтый** — частично покрыта (например, одна ветка if выполнена, другая нет)
- **Серый** — комментарии, пустые строки, не считаются

### Что важно смотреть:

- красные строки внутри `if` → значит тесты не проверяют эту ветку
- красные строки внутри `except` → тесты не проверяют ошибки
- красные строки в расчётах → тесты не проверяют этот сценарий
- красные строки в RT‑override → тесты не проверяют конкретный тип override

---

## Как понять, что покрытие хорошее

Ориентиры:

- **70%+** — нормально
- **80–90%** — хорошо
- **90–95%** — отлично
- **95%+** — промышленный уровень

Но главное — не процент, а **какие именно строки красные**.

Если красные строки:

- в логах → нормально
- в ошибках → нормально
- в safety‑гейтах → плохо
- в расчётах → плохо
- в RT‑override → плохо

---

## Как использовать отчёт для улучшения тестов

### 1. Найди красные строки в `autoisf_algorithm.py`
Например:

```
if rt_disable_basal:
    raw_rate = 0.0
```

Если эта строка красная → значит тесты не проверяют случай, когда:

```
_raw_text содержит "zero temp" или "projected below"
```

### 2. Напиши тест, который вызывает эту ветку

### 3. Запусти pytest снова

### 4. Смотри, что стало зелёным

---
